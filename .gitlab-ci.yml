stages:
  - sync

sync_to_github:
  stage: sync
  image: alpine:latest
  before_script:
    - apk add --no-cache git
    - git config --global user.name "Amine Saidi"
    - git config --global user.email "saidi.amine2023@gitlab.com"
    - git fetch --unshallow || true
  script:
    # ğŸ‘‰ Test pour voir si la variable est bien injectÃ©e
    - echo "Token dÃ©tectÃ© ? ${GITHUB_TOKEN:+âœ… Oui}" || echo "âŒ Non"

    # ğŸ‘‰ Si le token est bien dÃ©tectÃ©, on pousse vers GitHub
    - git remote add github https://oauth2:${GITHUB_TOKEN}@github.com/Spakalao/Todo-List.git
    - git remote -v
    - git push --mirror github
  only:
    - master
  variables:
    GIT_DEPTH: "0"
